function rodas54(f, u0, a,b,N)
    
    h = (b-a)/N
    t = collect(a:h:b)
    u = zeros(length(u0), n)
    u[:, 1] = u0

    # Butcher table for Rodas 5(4) method
    c = [0; 1/2; 83/250; 31/50; 17/20; 1]
    a = [
        0 0 0 0 0;
        1/2 0 0 0 0;
        13861/62500 6889/62500 0 0 0;
        -116923316275/2393684061468 -2731218467317/15368042101831 9408046702089/11113171139209 0 0;
        -451086348788/2902428689909 -2682348792572/7519795681897 12662868775082/11960479115383 3355817975965/11060851509271 0;
        647845179188/3216320057751 73281519250/8382639484533 552539513391/3454668386233 3354512671639/8306763924573 4040/17871
    ]
    b = [82889/524892, 0, 15625/83664, 69875/102672, -2260/8211, 1/4]
    bhat = [4586570599/29645900160, 0, 178811875/945068544, 814220225/1159782912, -3700637/11593932, 61727/225920]

    for i in 1:n-1
        u_new = u[:, i]
        t_new = t[i]

        while t_new < t[i+1]
            h_new = min(h, t[i+1] - t_new)
            k = zeros(length(u0), 6)

            for j in 1:6
                t_stage = t_new + c[j] * h_new
                u_stage = u_new + h_new * sum(a[j, k] .* k, dims=2)
                k[:, j] = f(t_stage, u_stage)
            end

            u_hat = u_new + h_new * sum(bhat .* k, dims=2)
            u_new = u_new + h_new * sum(b .* k, dims=2)
            t_new += h_new
        end

        u[:, i+1] = u_new
    end

    return t, u
end
